<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0a0e27">
    <title>Triggerhappy_ — Other</title>
    <link rel="stylesheet" href="styles.css">

</head>
<body>
    <header>
        <h1 class="name">Triggerhappy_</h1>

        <nav class="nav-bar">
            <a href="writings.html" class="nav-item">writings</a>
            <a href="music.html" class="nav-item">music</a>
            <a href="index.html" class="nav-item">about me</a>
            <a href="art.html" class="nav-item">art</a>
            <a href="other.html" class="nav-item active">other</a>
        </nav>
        <div id="status-badge">
            <span id="status-text">Loading…</span>
        </div>
    </header>

    <main>
        <section class="gallery-section">
            <h1>Other Gallery</h1>
            <p>Here are some of my other creations... Its a mess.. I know</p>
            <p>Id love to have a nice conversation in <a href="https://discord.gg/67FeGCtC45" target="_blank" style="color: #00d4ff; text-decoration: underline;">My discord server</a></p>
            <div class="gallery" id="gallery" role="region" aria-label="Video Gallery">
                <div class="empty-state">Loading other projects...</div>
            </div>
        </section>
    </main>
<footer class="site-footer">
    <p>© triggerhappy072@gmail.com. All rights reserved.</p>
</footer>
    <script>
        let allVideos = [];

        // Load videos from JSON
        async function loadVideos() {
            try {
                const response = await fetch('other/other.json');
                allVideos = await response.json();

                // Sort by number descending
                allVideos.sort((a, b) => b.number - a.number);

                renderGallery();
            } catch (error) {
                console.error('Failed to load other JSON:', error);
                document.getElementById('gallery').innerHTML = '<div class="empty-state">Could not load other projects.</div>';
            }
        }

        function getYouTubeEmbedUrl(url) {
            // Handle various YouTube URL formats
            let videoId;

            if (url.includes('youtube.com/watch?v=')) {
                videoId = url.split('v=')[1].split('&')[0];
            } else if (url.includes('youtu.be/')) {
                videoId = url.split('youtu.be/')[1].split('?')[0];
            } else if (url.includes('youtube.com/embed/')) {
                videoId = url.split('embed/')[1].split('?')[0];
            } else {
                // Assume it's already a video ID
                videoId = url;
            }

            return `https://www.youtube.com/embed/${videoId}`;
        }

        function renderGallery() {
            const gallery = document.getElementById('gallery');

            if (allVideos.length === 0) {
                gallery.innerHTML = '<div class="empty-state">No videos available.</div>';
                return;
            }

            gallery.innerHTML = allVideos.map(video => {
                const hasBlur = video.tags && video.tags.some(t => t.toLowerCase() === 'blur');
                let videoElement;

                if (video.type === 'mp4') {
                    videoElement = `<video controls><source src="${video.url}" type="video/mp4">Your browser does not support the video tag.</video>`;
                } else {
                    // YouTube video
                    const embedUrl = getYouTubeEmbedUrl(video.url);
                    videoElement = `<iframe src="${embedUrl}" title="${video.title}" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
                }

                return `
                <div class="gallery-item ${hasBlur ? 'blur' : ''}">
                    <div class="gallery-item-video" style="position: relative;">
                        ${videoElement}
                        ${hasBlur ? `
                        <div class="blur-overlay" onclick="this.parentElement.parentElement.classList.remove('blur'); this.remove();">
                            <span>
                                ⚠️ This video may contain sensitive content.<br>
                                Click to reveal.
                            </span>
                        </div>` : ''}
                    </div>
                    <div class="gallery-item-info">
                        <div>
                            <h3>${video.title}</h3>
                            ${video.date ? `<div class="video-date">Posted: ${video.date}</div>` : ''}
                            ${video.description ? `<p>${video.description}</p>` : ''}
                        </div>
                    </div>
                </div>`;
            }).join('');
        }

        // Load videos on page load
        loadVideos();

        // Set active nav item based on current page
        const items = document.querySelectorAll('.nav-item');
        const currentPage = window.location.pathname.split('/').pop() || 'index.html';
        items.forEach(item => {
            const href = item.getAttribute('href');
            if (href && href.endsWith(currentPage)) item.classList.add('active');
        });

    // ---- Status loader ----
    fetch("status.json")
        .then(res => res.json())
        .then(data => {
            document.getElementById("status-text").textContent =
                data.text || "No status";
        })
        .catch(err => {
            console.error("Failed to load status.json:", err);
            document.getElementById("status-text").textContent = "Status unavailable";
        });
    </script>
</body>
</html>
