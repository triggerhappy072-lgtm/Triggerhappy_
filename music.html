<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0a0e27">
    <title>Triggerhappy_ — Music</title>
    <link rel="stylesheet" href="styles.css">

</head>
<body>

<header>
    <h1 class="name">Triggerhappy_</h1>

    <nav class="nav-bar">
        <a href="writings.html" class="nav-item">writings</a>
        <a href="music.html" class="nav-item active">music</a>
        <a href="index.html" class="nav-item">about me</a>
        <a href="art.html" class="nav-item">art</a>
        <a href="other.html" class="nav-item">other</a>
    </nav>
    <div id="status-badge">
        <span id="status-text">Loading…</span>
    </div>
</header>

<main>
    <section class="music">
        <h2>little sound doodles</h2>
        <p>I'd love to hear your music in <a href="https://discord.gg/67FeGCtC45" target="_blank" style="color: #00d4ff; text-decoration: underline;">My discord server</a></p>
        <div id="trackList"></div>
    </section>
</main>
<footer class="site-footer">
    <p>© triggerhappy072@gmail.com. All rights reserved.</p>
</footer>
<script>
fetch("music/music.json")
    .then(res => res.json())
    .then(data => {
        const list = document.getElementById("trackList");

        // sort: highest number (newest) first
        data.sort((a, b) => b.number - a.number);

        data.forEach(track => {
            const div = document.createElement("div");
            div.className = "track";

            const ext = track.file.split('.').pop().toLowerCase();
            const mime =
                ext === "m4a" ? "audio/mp4" :
                ext === "mp3" ? "audio/mpeg" :
                `audio/${ext}`;

            div.innerHTML = `
                <div class="track-title">
                    <span class="track-number">#${track.number}</span>
                    ${track.title}
                </div>
                ${track.note || track.date ? `
                <div class="track-note">
                    ${track.note || ""}
                    ${track.date ? `<span style="opacity:0.7; font-size:0.85rem;">• ${track.date}</span>` : ""}
                </div>` : ""}
                <audio controls preload="none">
                    <source src="music/${track.file}" type="${mime}">
                    Your browser does not support the audio element.
                </audio>
            `;

            list.appendChild(div);
        });
    })
    .catch(err => {
        console.error("Failed to load music list:", err);
    });

    // ---- Status loader ----
    fetch("status.json")
        .then(res => res.json())
        .then(data => {
            document.getElementById("status-text").textContent =
                data.text || "No status";
        })
        .catch(err => {
            console.error("Failed to load status.json:", err);
            document.getElementById("status-text").textContent = "Status unavailable";
        });
</script>
</body>
</html>
